{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect}from'react';// antd imports\nimport{Table}from'antd';import'../../theming/antd.css';// material-ui imports\nimport{makeStyles}from'@material-ui/core/styles';import{useDispatch,useSelector}from'react-redux';import PetPreviewProfileComponent from'components/pet-profile/PetPreviewProfileComponent';import PriceTag from'components/PriceTag';import{getAdminTransactions,updateTransaction}from'redux/actions';import moment from'moment';import{Chip}from'@material-ui/core';import AdminStatusTag from'components/tags/AdminStatusTag';import Loading from'components/Loading';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TransactionsAdminOverviewTable=function TransactionsAdminOverviewTable(props){var classes=useStyles();var dispatch=useDispatch();var transactions=useSelector(function(state){return state.transaction.transactions;});// states\nvar checkRequiresInvestigation=function checkRequiresInvestigation(t){return t.senderResponse==='fail'&&t.receiverResponse==='success'||t.senderResponse==='success'&&t.receiverResponse==='fail';};useEffect(function(){if(props.active){//get transactions when tab is opened\ndispatch(getAdminTransactions(props.user.id));}},[props,dispatch]);// update transaction on confirming to change the transaction status\nvar confirm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(transaction){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(updateTransaction(transaction));case 2:_context.next=4;return dispatch(getAdminTransactions(props.user.id));case 4:case\"end\":return _context.stop();}}},_callee);}));return function confirm(_x){return _ref.apply(this,arguments);};}();// get the owner of the pet\nvar getPetOwner=function getPetOwner(transaction){var _transaction$pet,_transaction$senderId;if(((_transaction$pet=transaction.pet)===null||_transaction$pet===void 0?void 0:_transaction$pet.ownerId)===((_transaction$senderId=transaction.senderId)===null||_transaction$senderId===void 0?void 0:_transaction$senderId._id)){return transaction.senderId;}else{return transaction.receiverId;}};var columns=[{title:'ID',dataIndex:'orderNr',key:'orderNr',render:function render(id){return/*#__PURE__*/_jsx(\"p\",{children:String(id).toUpperCase()});}},{title:'MATE',dataIndex:'pet',key:'pet',align:'center',render:function render(_,record){return/*#__PURE__*/_jsx(PetPreviewProfileComponent,{username:getPetOwner(record).username,pet:record.pet});}},{title:'AMOUNT',dataIndex:'amount',key:'amount',align:'right',render:function render(_,record){return/*#__PURE__*/_jsx(PriceTag,{price:record.amount,fee:record.fee});}},{title:'DEADLINE',dataIndex:'deadline',key:'deadline',align:'center',render:function render(deadline){return/*#__PURE__*/_jsx(\"div\",{children:String(moment(deadline).format('LLL'))});}},{title:'SENDER RESPONSE',key:'response',dataIndex:'response',render:function render(_,record){return/*#__PURE__*/_jsx(AdminStatusTag,{variant:\"sender\",status:record.senderResponse,confirm:confirm,transaction:record});}},{title:'RECEIVER RESPONSE',key:'response',dataIndex:'response',render:function render(_,record){return/*#__PURE__*/_jsx(AdminStatusTag,{variant:\"receiver\",status:record.receiverResponse,confirm:confirm,transaction:record});}},{title:'STATUS',key:'status',dataIndex:'status',align:'center',render:function render(_,record){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(AdminStatusTag,{variant:\"default\",status:record.status,confirm:confirm,transaction:record})}),checkRequiresInvestigation(record)?/*#__PURE__*/_jsx(Chip,{className:classes.tags,variant:\"outlined\",label:\"Requires Investigation\",style:{color:'black',background:'#FCCA46',borderColor:'#FDCD7F',borderWidth:2,fontWeight:'lighter'}}):null]});}}];return/*#__PURE__*/ (//if transactions are loaded, shw the table; otherwise loading indicator\n_jsx(\"div\",{children:transactions?/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:transactions}):/*#__PURE__*/_jsx(Loading,{})}));};var useStyles=makeStyles(function(theme){return{layout:{display:'flex',flexDirection:'row',justifyContent:'center',alignItems:'center'},label:{fontSize:16,fontWeight:500},grid:{display:'flex',justifyContent:'flex-end',alignSelf:'flex-end'},tags:{marginTop:10}};});export default TransactionsAdminOverviewTable;","map":{"version":3,"sources":["/Users/alinaturbina/Uni Projects/seba/frontend/src/components/transactions/TransactionsAdminOverviewTable.js"],"names":["React","useEffect","Table","makeStyles","useDispatch","useSelector","PetPreviewProfileComponent","PriceTag","getAdminTransactions","updateTransaction","moment","Chip","AdminStatusTag","Loading","TransactionsAdminOverviewTable","props","classes","useStyles","dispatch","transactions","state","transaction","checkRequiresInvestigation","t","senderResponse","receiverResponse","active","user","id","confirm","getPetOwner","pet","ownerId","senderId","_id","receiverId","columns","title","dataIndex","key","render","String","toUpperCase","align","_","record","username","amount","fee","deadline","format","status","tags","color","background","borderColor","borderWidth","fontWeight","theme","layout","display","flexDirection","justifyContent","alignItems","label","fontSize","grid","alignSelf","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\n// antd imports\nimport { Table } from 'antd';\nimport '../../theming/antd.css';\n// material-ui imports\nimport { makeStyles } from '@material-ui/core/styles';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PetPreviewProfileComponent from 'components/pet-profile/PetPreviewProfileComponent';\nimport PriceTag from 'components/PriceTag';\nimport { getAdminTransactions, updateTransaction } from 'redux/actions';\nimport moment from 'moment';\nimport { Chip } from '@material-ui/core';\nimport AdminStatusTag from 'components/tags/AdminStatusTag';\nimport Loading from 'components/Loading';\n\nconst TransactionsAdminOverviewTable = (props) => {\n    const classes = useStyles();\n    const dispatch = useDispatch();\n    const transactions = useSelector((state) => state.transaction.transactions);\n\n    // states\n    const checkRequiresInvestigation = (t) => (t.senderResponse === 'fail' && t.receiverResponse === 'success') || (t.senderResponse === 'success' && t.receiverResponse === 'fail');\n\n    useEffect(() => {\n        \n           if (props.active) { //get transactions when tab is opened\n            dispatch(getAdminTransactions(props.user.id)); \n            \n        }       \n    }, [props, dispatch])\n\n\n\n    // update transaction on confirming to change the transaction status\n    const confirm = async (transaction) => {\n        await dispatch(updateTransaction(transaction));\n        await dispatch(getAdminTransactions(props.user.id));\n    };\n\n    // get the owner of the pet\n    const getPetOwner = (transaction) => {\n        if (transaction.pet?.ownerId === transaction.senderId?._id) {\n            return transaction.senderId;\n        } else {\n            return transaction.receiverId;\n        }\n    };\n\n    const columns = [\n        {\n            title: 'ID',\n            dataIndex: 'orderNr',\n            key: 'orderNr',\n            render: (id) => <p>{String(id).toUpperCase()}</p>,\n        },\n        {\n            title: 'MATE',\n            dataIndex: 'pet',\n            key: 'pet',\n            align: 'center',\n            render: (_, record) => <PetPreviewProfileComponent username={getPetOwner(record).username} pet={record.pet} />,\n        },\n        {\n            title: 'AMOUNT',\n            dataIndex: 'amount',\n            key: 'amount',\n            align: 'right',\n            render: (_, record) => <PriceTag price={record.amount} fee={record.fee} />,\n        },\n        {\n            title: 'DEADLINE',\n            dataIndex: 'deadline',\n            key: 'deadline',\n            align: 'center',\n            render: (deadline) => <div>{String(moment(deadline).format('LLL'))}</div>,\n        },\n        {\n            title: 'SENDER RESPONSE',\n            key: 'response',\n            dataIndex: 'response',\n            render: (_, record) => <AdminStatusTag variant=\"sender\" status={record.senderResponse}  confirm={confirm} transaction={record} />,\n        },\n        {\n            title: 'RECEIVER RESPONSE',\n            key: 'response',\n            dataIndex: 'response',\n            render: (_, record) => (\n                <AdminStatusTag variant=\"receiver\" status={record.receiverResponse} confirm={confirm} transaction={record} />\n            ),\n        },\n        {\n            title: 'STATUS',\n            key: 'status',\n            dataIndex: 'status',\n            align: 'center',\n            render: (_, record) => (\n                <>\n                    <div>\n                        <AdminStatusTag variant=\"default\" status={record.status} confirm={confirm} transaction={record} />\n                    </div>\n                    {checkRequiresInvestigation(record) ? (\n                        <Chip className={classes.tags} variant=\"outlined\" label=\"Requires Investigation\" style={{color: 'black', background: '#FCCA46', borderColor: '#FDCD7F', borderWidth: 2, fontWeight: 'lighter'}} />\n                    ) : null}\n                </>\n            ),\n        },\n    ];\n\n    return (//if transactions are loaded, shw the table; otherwise loading indicator\n        <div>\n            {transactions? <Table columns={columns} dataSource={transactions} /> : <Loading />} \n        </div>\n    );\n};\n\nconst useStyles = makeStyles((theme) => ({\n    layout: {\n        display: 'flex',\n        flexDirection: 'row',\n        justifyContent: 'center',\n        alignItems: 'center',\n    },\n    label: {\n        fontSize: 16,\n        fontWeight: 500,\n    },\n    grid: {\n        display: 'flex',\n        justifyContent: 'flex-end',\n        alignSelf: 'flex-end',\n    },\n    tags: {\n        marginTop: 10,\n    },\n}));\n\nexport default TransactionsAdminOverviewTable;\n"]},"metadata":{},"sourceType":"module"}