{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import axios from'axios';import moment from'moment';var AxiosConfiguration=/*#__PURE__*/function(){function AxiosConfiguration(){var _this=this;_classCallCheck(this,AxiosConfiguration);this.setNewCancelToken=function(){return _this.cancelSource=axios.CancelToken.source();};this.getHeader=function(){return{Authorization:'Bearer '+localStorage['jwtToken'],'Content-Type':'application/json','x-timezone-offset':moment().utcOffset()};};this.cancelSource=axios.CancelToken.source();axios.defaults.baseURL='http://localhost:4000';}_createClass(AxiosConfiguration,[{key:\"setupInterceptors\",value:function setupInterceptors(){this.setupRequestInterceptor();this.setupResponseInterceptor();}// this should be called right after the login\n},{key:\"setupRequestInterceptor\",value:function setupRequestInterceptor(){var _this2=this;axios.interceptors.request.use(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(config){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage['jwtToken']!==null){config.headers=_this2.getHeader();}_this2.setNewCancelToken();config.cancelToken=_this2.cancelSource.token;return _context.abrupt(\"return\",config);case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),function(error){return Promise.reject(error);});}},{key:\"setupResponseInterceptor\",value:function setupResponseInterceptor(){axios.interceptors.response.use(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",response);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}(),/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(error){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",Promise.reject(error.response));case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());}}]);return AxiosConfiguration;}();export default new AxiosConfiguration();","map":{"version":3,"sources":["/Users/alinaturbina/Uni Projects/seba/frontend/src/helper/axios.js"],"names":["axios","moment","AxiosConfiguration","setNewCancelToken","cancelSource","CancelToken","source","getHeader","Authorization","localStorage","utcOffset","defaults","baseURL","setupRequestInterceptor","setupResponseInterceptor","interceptors","request","use","config","headers","cancelToken","token","error","Promise","reject","response"],"mappings":"+oBAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,QAAnB,C,GAEMC,CAAAA,kB,yBACF,6BAAc,8DAWdC,iBAXc,CAWM,iBAAO,CAAA,KAAI,CAACC,YAAL,CAAoBJ,KAAK,CAACK,WAAN,CAAkBC,MAAlB,EAA3B,EAXN,MAadC,SAbc,CAaF,iBAAO,CACfC,aAAa,CAAE,UAAYC,YAAY,CAAC,UAAD,CADxB,CAEf,eAAgB,kBAFD,CAGf,oBAAqBR,MAAM,GAAGS,SAAT,EAHN,CAAP,EAbE,CACV,KAAKN,YAAL,CAAoBJ,KAAK,CAACK,WAAN,CAAkBC,MAAlB,EAApB,CACAN,KAAK,CAACW,QAAN,CAAeC,OAAf,CAAyB,uBAAzB,CACH,C,gEAED,4BAAoB,CAChB,KAAKC,uBAAL,GACA,KAAKC,wBAAL,GACH,CAED;uCASA,kCAA0B,iBACtBd,KAAK,CAACe,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,0FACI,iBAAOC,MAAP,kHACI,GAAIT,YAAY,CAAC,UAAD,CAAZ,GAA6B,IAAjC,CAAuC,CACnCS,MAAM,CAACC,OAAP,CAAiB,MAAI,CAACZ,SAAL,EAAjB,CACH,CAED,MAAI,CAACJ,iBAAL,GACAe,MAAM,CAACE,WAAP,CAAqB,MAAI,CAAChB,YAAL,CAAkBiB,KAAvC,CANJ,gCAOWH,MAPX,wDADJ,+DAUI,SAACI,KAAD,QAAWC,CAAAA,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAX,EAVJ,EAYH,C,wCAED,mCAA2B,CACvBtB,KAAK,CAACe,YAAN,CAAmBU,QAAnB,CAA4BR,GAA5B,2FACI,kBAAOQ,QAAP,uJACWA,QADX,0DADJ,2JAII,kBAAOH,KAAP,uJACWC,OAAO,CAACC,MAAR,CAAeF,KAAK,CAACG,QAArB,CADX,0DAJJ,kEAQH,C,kCAGL,cAAe,IAAIvB,CAAAA,kBAAJ,EAAf","sourcesContent":["import axios from 'axios';\nimport moment from 'moment';\n\nclass AxiosConfiguration {\n    constructor() {\n        this.cancelSource = axios.CancelToken.source();\n        axios.defaults.baseURL = 'http://localhost:4000';\n    }\n\n    setupInterceptors() {\n        this.setupRequestInterceptor();\n        this.setupResponseInterceptor();\n    }\n\n    // this should be called right after the login\n    setNewCancelToken = () => (this.cancelSource = axios.CancelToken.source());\n\n    getHeader = () => ({\n        Authorization: 'Bearer ' + localStorage['jwtToken'],\n        'Content-Type': 'application/json',\n        'x-timezone-offset': moment().utcOffset(),\n    });\n\n    setupRequestInterceptor() {\n        axios.interceptors.request.use(\n            async (config: any) => {\n                if (localStorage['jwtToken'] !== null) {\n                    config.headers = this.getHeader();\n                }\n\n                this.setNewCancelToken();\n                config.cancelToken = this.cancelSource.token;\n                return config;\n            },\n            (error) => Promise.reject(error)\n        );\n    }\n\n    setupResponseInterceptor() {\n        axios.interceptors.response.use(\n            async (response) => {\n                return response;\n            },\n            async (error) => {\n                return Promise.reject(error.response);\n            }\n        );\n    }\n}\n\nexport default new AxiosConfiguration();\n"]},"metadata":{},"sourceType":"module"}