{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";var HttpService=/*#__PURE__*/function(){function HttpService(){_classCallCheck(this,HttpService);}_createClass(HttpService,null,[{key:\"extractUser\",value:function extractUser(token){var base64Url=token.split('.')[1];var base64=base64Url.replace('-','+').replace('_','/');var userJson=JSON.parse(atob(base64));return{id:userJson._id,username:userJson.username,role:userJson.role};}},{key:\"get\",value:function(){var _get=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url,onSuccess,onError){var token,header,resp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=window.localStorage['jwtToken'];header=new Headers();if(token){header.append('Authorization',\"JWT \".concat(token));}_context.prev=3;_context.next=6;return fetch(url,{method:'GET',headers:header});case 6:resp=_context.sent;if(!this.checkIfUnauthorized(resp)){_context.next=11;break;}window.location='/login';_context.next=14;break;case 11:_context.next=13;return resp.json();case 13:resp=_context.sent;case 14:if(resp.error){onError(resp.error);}else{if(resp.hasOwnProperty('token')){window.localStorage['jwtToken']=resp.token;resp.user=this.extractUser(resp.token);}onSuccess(resp);}_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](3);onError(_context.t0.message);case 20:case\"end\":return _context.stop();}}},_callee,this,[[3,17]]);}));function get(_x,_x2,_x3){return _get.apply(this,arguments);}return get;}()},{key:\"put\",value:function(){var _put=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(url,data,onSuccess,onError){var token,header,resp;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:token=window.localStorage['jwtToken'];header=new Headers();if(token){header.append('Authorization',\"JWT \".concat(token));}header.append('Content-Type','application/json');_context2.prev=4;_context2.next=7;return fetch(url,{method:'PUT',headers:header,body:JSON.stringify(data)});case 7:resp=_context2.sent;if(!this.checkIfUnauthorized(resp)){_context2.next=13;break;}window.location='/login';return _context2.abrupt(\"return\");case 13:_context2.next=15;return resp.json();case 15:resp=_context2.sent;case 16:if(resp.error){onError(resp.error);}else{if(resp.hasOwnProperty('token')){window.localStorage['jwtToken']=resp.token;resp.user=this.extractUser(resp.token);}onSuccess(resp);}_context2.next=22;break;case 19:_context2.prev=19;_context2.t0=_context2[\"catch\"](4);onError(_context2.t0.message);case 22:case\"end\":return _context2.stop();}}},_callee2,this,[[4,19]]);}));function put(_x4,_x5,_x6,_x7){return _put.apply(this,arguments);}return put;}()},{key:\"post\",value:function(){var _post=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url,data,onSuccess,onError){var token,header,resp;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:token=window.localStorage['jwtToken'];header=new Headers();if(token){header.append('Authorization',\"JWT \".concat(token));}header.append('Content-Type','application/json');_context3.prev=4;_context3.next=7;return fetch(url,{method:'POST',headers:header,body:JSON.stringify(data)});case 7:resp=_context3.sent;if(!this.checkIfUnauthorized(resp)){_context3.next=13;break;}window.location='/login';return _context3.abrupt(\"return\");case 13:_context3.next=15;return resp.json();case 15:resp=_context3.sent;case 16:if(resp.error){onError(resp.error);}else{if(resp.hasOwnProperty('token')){window.localStorage['jwtToken']=resp.token;resp.user=this.extractUser(resp.token);}onSuccess(resp);}_context3.next=22;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](4);onError(_context3.t0.message);case 22:case\"end\":return _context3.stop();}}},_callee3,this,[[4,19]]);}));function post(_x8,_x9,_x10,_x11){return _post.apply(this,arguments);}return post;}()},{key:\"remove\",value:function(){var _remove=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(url,onSuccess,onError){var token,header,resp;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:token=window.localStorage['jwtToken'];header=new Headers();if(token){header.append('Authorization',\"JWT \".concat(token));}_context4.prev=3;_context4.next=6;return fetch(url,{method:'DELETE',headers:header});case 6:resp=_context4.sent;if(!this.checkIfUnauthorized(resp)){_context4.next=12;break;}window.location='/login';return _context4.abrupt(\"return\");case 12:_context4.next=14;return resp.json();case 14:resp=_context4.sent;case 15:if(resp.error){onError(resp.error);}else{onSuccess(resp);}_context4.next=21;break;case 18:_context4.prev=18;_context4.t0=_context4[\"catch\"](3);onError(_context4.t0.message);case 21:case\"end\":return _context4.stop();}}},_callee4,this,[[3,18]]);}));function remove(_x12,_x13,_x14){return _remove.apply(this,arguments);}return remove;}()},{key:\"checkIfUnauthorized\",value:function checkIfUnauthorized(res){if(res.status===401){return true;}return false;}}]);return HttpService;}();export{HttpService as default};","map":{"version":3,"sources":["/Users/alinaturbina/Uni Projects/seba/frontend/src/services/HttpService.js"],"names":["HttpService","token","base64Url","split","base64","replace","userJson","JSON","parse","atob","id","_id","username","role","url","onSuccess","onError","window","localStorage","header","Headers","append","fetch","method","headers","resp","checkIfUnauthorized","location","json","error","hasOwnProperty","user","extractUser","message","data","body","stringify","res","status"],"mappings":"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","sourcesContent":["export default class HttpService {\n    static extractUser(token) {\n        let base64Url = token.split('.')[1];\n        let base64 = base64Url.replace('-', '+').replace('_', '/');\n        let userJson = JSON.parse(atob(base64));\n        return {\n            id: userJson._id,\n            username: userJson.username,\n            role: userJson.role\n        };\n    }\n\n    static async get(url, onSuccess, onError) {\n        let token = window.localStorage['jwtToken'];\n        let header = new Headers();\n        if (token) {\n            header.append('Authorization', `JWT ${token}`);\n        }\n\n        try {\n            let resp = await fetch(url, {\n                method: 'GET',\n                headers: header,\n            });\n\n            if (this.checkIfUnauthorized(resp)) {\n                window.location = '/login';\n            } else {\n                resp = await resp.json();\n            }\n\n            if (resp.error) {\n                onError(resp.error);\n            } else {\n                if (resp.hasOwnProperty('token')) {\n                    window.localStorage['jwtToken'] = resp.token;\n                    resp.user = this.extractUser(resp.token);\n                }\n                onSuccess(resp);\n            }\n        } catch (err) {\n            onError(err.message);\n        }\n    }\n\n    static async put(url, data, onSuccess, onError) {\n        let token = window.localStorage['jwtToken'];\n        let header = new Headers();\n        if (token) {\n            header.append('Authorization', `JWT ${token}`);\n        }\n        header.append('Content-Type', 'application/json');\n\n        try {\n            let resp = await fetch(url, {\n                method: 'PUT',\n                headers: header,\n                body: JSON.stringify(data),\n            });\n\n            if (this.checkIfUnauthorized(resp)) {\n                window.location = '/login';\n                return;\n            } else {\n                resp = await resp.json();\n            }\n\n            if (resp.error) {\n                onError(resp.error);\n            } else {\n                if (resp.hasOwnProperty('token')) {\n                    window.localStorage['jwtToken'] = resp.token;\n                    resp.user = this.extractUser(resp.token);\n                }\n                onSuccess(resp);\n            }\n        } catch (err) {\n            onError(err.message);\n        }\n    }\n\n    static async post(url, data, onSuccess, onError) {\n        let token = window.localStorage['jwtToken'];\n        let header = new Headers();\n        if (token) {\n            header.append('Authorization', `JWT ${token}`);\n        }\n        header.append('Content-Type', 'application/json');\n\n        try {\n            let resp = await fetch(url, {\n                method: 'POST',\n                headers: header,\n                body: JSON.stringify(data),\n            });\n\n            if (this.checkIfUnauthorized(resp)) {\n                window.location = '/login';\n                return;\n            } else {\n                resp = await resp.json();\n            }\n\n            if (resp.error) {\n                onError(resp.error);\n            } else {\n                if (resp.hasOwnProperty('token')) {\n                    window.localStorage['jwtToken'] = resp.token;\n                    resp.user = this.extractUser(resp.token);\n                }\n                onSuccess(resp);\n            }\n        } catch (err) {\n            onError(err.message);\n        }\n    }\n\n    static async remove(url, onSuccess, onError) {\n        let token = window.localStorage['jwtToken'];\n        let header = new Headers();\n        if (token) {\n            header.append('Authorization', `JWT ${token}`);\n        }\n\n        try {\n            let resp = await fetch(url, {\n                method: 'DELETE',\n                headers: header,\n            });\n\n            if (this.checkIfUnauthorized(resp)) {\n                window.location = '/login';\n                return;\n            } else {\n                resp = await resp.json();\n            }\n\n            if (resp.error) {\n                onError(resp.error);\n            } else {\n                onSuccess(resp);\n            }\n        } catch (err) {\n            onError(err.message);\n        }\n    }\n\n    static checkIfUnauthorized(res) {\n        if (res.status === 401) {\n            return true;\n        }\n        return false;\n    }\n}\n"]},"metadata":{},"sourceType":"module"}