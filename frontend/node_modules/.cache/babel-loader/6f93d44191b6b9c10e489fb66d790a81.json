{"ast":null,"code":"import _regeneratorRuntime from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/alinaturbina/Uni Projects/seba/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useRef}from'react';import{connect,useSelector}from'react-redux';import{makeStyles}from'@material-ui/core/styles';import{withRouter}from'react-router-dom';import FormControl from'@material-ui/core/FormControl';import Select from'@material-ui/core/Select';import InputLabel from'@material-ui/core/InputLabel';import MenuItem from'@material-ui/core/MenuItem';import Typography from'@material-ui/core/Typography';import Slider from'@material-ui/core/Slider';import Button from'@material-ui/core/Button';import Box from'@material-ui/core/Box';import Pagination from'@material-ui/lab/Pagination';import{getPets}from'../redux/actions/petActions';import SearchResults from'../components/search/SearchResults';import{breeds}from'helper/data/breeds';import HomeLogo from\"images/home.svg\";import{Grid}from'@material-ui/core';import{useUser}from'helper/hooks/auth.hooks';import{useLoggedInUser}from'helper/hooks/auth.hooks';import PremiumBanner from'components/PremiumBanner';import{showPremiumBanner}from'helper/helpers';import{getUsersInfo}from'redux/actions';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{formControl:{margin:theme.spacing(1),minWidth:120},button:{margin:theme.spacing(2)},ageSlider:{margin:theme.spacing(4),marginLeft:50,marginRight:50,width:200},homeLogo:{display:'flex',justifyContent:'center',alignItems:'center',margin:50,marginRight:150},darkSlider:{color:theme.palette.primary.dark},filters:{display:'flex',flex:1,flexDirection:'row',alignItems:'baseline',justifyContent:'center'}};});function SearchView(props){var _breeds$chosenSpecies;var searchRef=useRef();var classes=useStyles();var pets=useSelector(function(state){return state.pets.pets;});// get pets from redux store\nvar user=useUser();// for scrolling to the search\nvar loggedInUser=useLoggedInUser();var totalPages=useSelector(function(state){return state.pets.pets.totalPages;});var _React$useState=React.useState(true),_React$useState2=_slicedToArray(_React$useState,2),isLoading=_React$useState2[0],setIsLoading=_React$useState2[1];var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),chosenSpecies=_React$useState4[0],setSpecies=_React$useState4[1];var _React$useState5=React.useState(''),_React$useState6=_slicedToArray(_React$useState5,2),order=_React$useState6[0],setOrder=_React$useState6[1];var _React$useState7=React.useState(''),_React$useState8=_slicedToArray(_React$useState7,2),sex=_React$useState8[0],setSex=_React$useState8[1];var _React$useState9=React.useState(''),_React$useState10=_slicedToArray(_React$useState9,2),breed=_React$useState10[0],setBreed=_React$useState10[1];var _React$useState11=React.useState([0.5,10]),_React$useState12=_slicedToArray(_React$useState11,2),ageRange=_React$useState12[0],setAgeRange=_React$useState12[1];var sexes=['female','male'];var orders=['ascending price','descending price','newest'];var ageMarks=[{value:0.5,label:'6 months'},{value:5,label:'5 years'},{value:10,label:'10 years'}];var loadPets=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(pageValue){var pageToFetch;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// trigger the redux action getPets\npageToFetch=pageValue?pageValue:1;pets=props.dispatch(getPets(chosenSpecies,sex,breed,ageRange,pageToFetch,false,user));case 2:case\"end\":return _context.stop();}}},_callee);}));return function loadPets(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(user){props.dispatch(getUsersInfo(user.id));}},[]);useEffect(function(){// load pets when the page is loaded or the pets were filtered.\nif(!pets||isLoading){loadPets(1);setIsLoading(false);}},[pets]);var updateFilters=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setSpecies('');setSex('');setBreed('');setAgeRange([1,10]);pets=props.dispatch(getPets('','','',[0.5,10],1,false,user));//change parameters manually because values remain constant inside render and are not updated immediately\ncase 5:case\"end\":return _context2.stop();}}},_callee2);}));return function updateFilters(){return _ref2.apply(this,arguments);};}();var resetFilters=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:updateFilters();case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function resetFilters(){return _ref3.apply(this,arguments);};}();var handleSpeciesChange=function handleSpeciesChange(event){setSpecies(event.target.value);};var handleSexChange=function handleSexChange(event){setSex(event.target.value);};var handleBreedChange=function handleBreedChange(event){setBreed(event.target.value);};var handleAgeRangeChange=function handleAgeRangeChange(event,newRange){setAgeRange(newRange);};var handleOrderChange=function handleOrderChange(event){setOrder(event.target.value);};function agetext(age){return\"\".concat(age,\" years old\");}var onSubscribe=function onSubscribe(){return props.history.push('/pricing');};var onSearchTrigger=function onSearchTrigger(){return searchRef.current.scrollIntoView({behavior:'smooth'});};function scrollToTargetAdjusted(){var _searchRef$current;var headerOffset=document.querySelector('#header').clientHeight;var elementPosition=(_searchRef$current=searchRef.current)===null||_searchRef$current===void 0?void 0:_searchRef$current.getBoundingClientRect().top;var offsetPosition=window.scrollY+elementPosition-headerOffset;window.scrollTo({top:offsetPosition,behavior:'smooth'});}var handleChange=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event,value){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:loadPets(value);scrollToTargetAdjusted();case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function handleChange(_x2,_x3){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[showPremiumBanner(loggedInUser)?/*#__PURE__*/_jsx(PremiumBanner,{}):null,/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"row\",justify:\"center\",children:[/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,xs:6,justify:\"center\",alignItems:\"flex-end\",direction:\"column\",children:[/*#__PURE__*/_jsx(Grid,{item:true,justify:\"flex-start\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Typography,{style:{fontSize:24},children:\"Find the best partner for your pet\"})}),/*#__PURE__*/_jsxs(Grid,{item:true,children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",style:{marginRight:20},onClick:onSearchTrigger,children:\"Search for a pet\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:onSubscribe,children:\"Subscribe\"})]})]}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,justify:\"flex-end\",alignItems:\"center\",children:/*#__PURE__*/_jsx(\"div\",{className:classes.homeLogo,children:/*#__PURE__*/_jsx(\"img\",{alt:\"home\",src:HomeLogo,style:{width:'25vw',height:'auto'}})})})]}),/*#__PURE__*/_jsxs(Grid,{container:true,direction:\"row\",ref:searchRef,justify:\"center\",alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsxs(FormControl,{className:classes.formControl,variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"species-select-label\",children:\"Species\"}),/*#__PURE__*/_jsx(Select,{labelId:\"species-select-label\",id:\"species-select\",value:chosenSpecies,onChange:handleSpeciesChange,label:\"Species\",children:Object.keys(breeds).map(function(oneSpecies){return/*#__PURE__*/_jsx(MenuItem,{value:oneSpecies,children:oneSpecies},oneSpecies);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsxs(FormControl,{className:classes.formControl,variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"sex-select-label\",children:\"Sex\"}),/*#__PURE__*/_jsx(Select,{labelId:\"sex-select-label\",id:\"sex-select\",value:sex,onChange:handleSexChange,label:\"Sex\",children:sexes.map(function(sex){return/*#__PURE__*/_jsx(MenuItem,{value:sex,children:sex},sex);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsxs(FormControl,{className:classes.formControl,variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"breed-select-label\",children:\"Breed\"}),/*#__PURE__*/_jsx(Select,{labelId:\"breed-select-label\",id:\"breed-select\",value:breed,onChange:handleBreedChange,label:\"Breed\",children:((_breeds$chosenSpecies=breeds[chosenSpecies])!==null&&_breeds$chosenSpecies!==void 0?_breeds$chosenSpecies:[]).map(function(breed){return/*#__PURE__*/_jsx(MenuItem,{value:breed,children:breed},breed);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsxs(FormControl,{className:classes.formControl,variant:\"outlined\",size:\"small\",children:[/*#__PURE__*/_jsx(InputLabel,{id:\"breed-select-label\",children:\"Sort by\"}),/*#__PURE__*/_jsx(Select,{labelId:\"breed-select-label\",id:\"sort-select\",value:order,onChange:handleOrderChange,label:\"Sort by\",children:orders.map(function(order){return/*#__PURE__*/_jsx(MenuItem,{value:order,children:order},order);})})]})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.ageSlider,children:[/*#__PURE__*/_jsx(Typography,{children:\"Age Range\"}),/*#__PURE__*/_jsx(Slider,{value:ageRange,onChange:handleAgeRangeChange,valueLabelDisplay:\"auto\",\"aria-labelledby\":\"range-slider\",getAriaValueText:agetext,min:0.5,max:10,marks:ageMarks,className:classes.darkSlider})]})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"default\",className:classes.button,onClick:loadPets,children:\"Apply\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"default\",className:classes.button,onClick:resetFilters,children:\"Reset filters\"})})]}),/*#__PURE__*/_jsx(SearchResults,{pets:pets,order:order}),totalPages?/*#__PURE__*/_jsx(Box,{my:2,display:\"flex\",justifyContent:\"center\",children:/*#__PURE__*/_jsx(Pagination,{count:totalPages,variant:\"outlined\",shape:\"rounded\",onChange:handleChange})}):null]});}export default connect()(withRouter(SearchView));","map":{"version":3,"sources":["/Users/alinaturbina/Uni Projects/seba/frontend/src/views/SearchView.js"],"names":["React","useEffect","useRef","connect","useSelector","makeStyles","withRouter","FormControl","Select","InputLabel","MenuItem","Typography","Slider","Button","Box","Pagination","getPets","SearchResults","breeds","Grid","useUser","useLoggedInUser","PremiumBanner","showPremiumBanner","getUsersInfo","useStyles","theme","formControl","margin","spacing","minWidth","button","ageSlider","marginLeft","marginRight","width","homeLogo","display","justifyContent","alignItems","darkSlider","color","palette","primary","dark","filters","flex","flexDirection","SearchView","props","searchRef","classes","pets","state","user","loggedInUser","totalPages","useState","isLoading","setIsLoading","chosenSpecies","setSpecies","order","setOrder","sex","setSex","breed","setBreed","ageRange","setAgeRange","sexes","orders","ageMarks","value","label","loadPets","pageValue","pageToFetch","dispatch","id","updateFilters","resetFilters","handleSpeciesChange","event","target","handleSexChange","handleBreedChange","handleAgeRangeChange","newRange","handleOrderChange","agetext","age","onSubscribe","history","push","onSearchTrigger","current","scrollIntoView","behavior","scrollToTargetAdjusted","headerOffset","document","querySelector","clientHeight","elementPosition","getBoundingClientRect","top","offsetPosition","window","scrollY","scrollTo","handleChange","fontSize","HomeLogo","height","Object","keys","map","oneSpecies"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { connect, useSelector } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { withRouter } from 'react-router-dom';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport Slider from '@material-ui/core/Slider';\nimport Button from '@material-ui/core/Button';\nimport Box from '@material-ui/core/Box';\nimport Pagination from '@material-ui/lab/Pagination';\nimport { getPets } from '../redux/actions/petActions';\nimport SearchResults from '../components/search/SearchResults';\nimport { breeds } from 'helper/data/breeds';\nimport HomeLogo from 'images/home.svg';\nimport { Grid } from '@material-ui/core';\nimport { useUser } from 'helper/hooks/auth.hooks';\nimport { useLoggedInUser } from 'helper/hooks/auth.hooks';\nimport PremiumBanner from 'components/PremiumBanner';\nimport { showPremiumBanner } from 'helper/helpers';\nimport { getUsersInfo } from 'redux/actions';\n\nconst useStyles = makeStyles((theme) => ({\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: 120,\n    },\n    button: {\n        margin: theme.spacing(2),\n    },\n    ageSlider: {\n        margin: theme.spacing(4),\n        marginLeft: 50,\n        marginRight: 50,\n        width: 200,\n    },\n    homeLogo: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        margin: 50,\n        marginRight: 150,\n    },\n    darkSlider: {\n        color: theme.palette.primary.dark,\n    },\n    filters: {\n        display: 'flex',\n        flex: 1,\n        flexDirection: 'row',\n        alignItems: 'baseline',\n        justifyContent: 'center',\n    },\n}));\n\nfunction SearchView(props) {\n    const searchRef = useRef();\n    const classes = useStyles();\n    let pets = useSelector((state) => state.pets.pets); // get pets from redux store\n    let user = useUser();\n    // for scrolling to the search\n    const loggedInUser = useLoggedInUser();\n    const totalPages = useSelector((state) => state.pets.pets.totalPages);\n\n    const [isLoading, setIsLoading] = React.useState(true);\n    const [chosenSpecies, setSpecies] = React.useState('');\n    const [order, setOrder] = React.useState('');\n    const [sex, setSex] = React.useState('');\n    const [breed, setBreed] = React.useState('');\n    const [ageRange, setAgeRange] = React.useState([0.5, 10]);\n\n    const sexes = ['female', 'male'];\n    const orders = ['ascending price', 'descending price', 'newest'];\n\n    const ageMarks = [\n        {\n            value: 0.5,\n            label: '6 months',\n        },\n        {\n            value: 5,\n            label: '5 years',\n        },\n        {\n            value: 10,\n            label: '10 years',\n        },\n    ];\n\n    const loadPets = async (pageValue) => {\n        // trigger the redux action getPets\n        let pageToFetch = pageValue ? pageValue : 1;\n        pets = props.dispatch(getPets(chosenSpecies, sex, breed, ageRange, pageToFetch, false, user));\n    };\n\n    useEffect(() => {\n        if (user) {\n            props.dispatch(getUsersInfo(user.id));\n        }\n    }, []);\n\n    useEffect(() => {\n        // load pets when the page is loaded or the pets were filtered.\n        if (!pets || isLoading) {\n            loadPets(1);\n            setIsLoading(false);\n        }\n    }, [pets]);\n\n    const updateFilters = async () => {\n        setSpecies('');\n        setSex('');\n        setBreed('');\n        setAgeRange([1, 10]);\n        pets = props.dispatch(getPets('', '', '', [0.5, 10], 1, false, user)); //change parameters manually because values remain constant inside render and are not updated immediately\n    };\n\n    const resetFilters = async () => {\n        updateFilters();\n    };\n\n    const handleSpeciesChange = (event) => {\n        setSpecies(event.target.value);\n    };\n\n    const handleSexChange = (event) => {\n        setSex(event.target.value);\n    };\n\n    const handleBreedChange = (event) => {\n        setBreed(event.target.value);\n    };\n\n    const handleAgeRangeChange = (event, newRange) => {\n        setAgeRange(newRange);\n    };\n\n    const handleOrderChange = (event) => {\n        setOrder(event.target.value);\n    };\n\n    function agetext(age) {\n        return `${age} years old`;\n    }\n\n    const onSubscribe = () => props.history.push('/pricing');\n\n    const onSearchTrigger = () => searchRef.current.scrollIntoView({ behavior: 'smooth' });\n\n    function scrollToTargetAdjusted() {\n        var headerOffset = document.querySelector('#header').clientHeight;\n        var elementPosition = searchRef.current?.getBoundingClientRect().top;\n        var offsetPosition = window.scrollY + elementPosition - headerOffset;\n        window.scrollTo({\n            top: offsetPosition,\n            behavior: 'smooth',\n        });\n    }\n\n    const handleChange = async (event, value) => {\n        loadPets(value);\n        scrollToTargetAdjusted();\n    };\n\n    return (\n        <div>\n            {showPremiumBanner(loggedInUser) ? <PremiumBanner /> : null}\n            <Grid container direction=\"row\" justify=\"center\">\n                <Grid container spacing={3} xs={6} justify=\"center\" alignItems=\"flex-end\" direction=\"column\">\n                    <Grid item justify=\"flex-start\" alignItems=\"center\">\n                        <Typography style={{ fontSize: 24 }}>Find the best partner for your pet</Typography>\n                    </Grid>\n                    <Grid item>\n                        <Button variant=\"contained\" color=\"primary\" style={{ marginRight: 20 }} onClick={onSearchTrigger}>\n                            Search for a pet\n                        </Button>\n                        <Button variant=\"contained\" color=\"primary\" onClick={onSubscribe}>\n                            Subscribe\n                        </Button>\n                    </Grid>\n                </Grid>\n                <Grid item xs={6} justify=\"flex-end\" alignItems=\"center\">\n                    <div className={classes.homeLogo}>\n                        <img alt=\"home\" src={HomeLogo} style={{ width: '25vw', height: 'auto' }} />\n                    </div>\n                </Grid>\n            </Grid>\n            <Grid container direction=\"row\" ref={searchRef} justify=\"center\" alignItems=\"center\">\n                <Grid item>\n                    <FormControl className={classes.formControl} variant=\"outlined\" size=\"small\">\n                        <InputLabel id=\"species-select-label\">Species</InputLabel>\n                        <Select labelId=\"species-select-label\" id=\"species-select\" value={chosenSpecies} onChange={handleSpeciesChange} label=\"Species\">\n                            {Object.keys(breeds).map((oneSpecies) => (\n                                <MenuItem key={oneSpecies} value={oneSpecies}>\n                                    {oneSpecies}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </Grid>\n                <Grid item>\n                    <FormControl className={classes.formControl} variant=\"outlined\" size=\"small\">\n                        <InputLabel id=\"sex-select-label\">Sex</InputLabel>\n                        <Select labelId=\"sex-select-label\" id=\"sex-select\" value={sex} onChange={handleSexChange} label=\"Sex\">\n                            {sexes.map((sex) => (\n                                <MenuItem key={sex} value={sex}>\n                                    {sex}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </Grid>\n                <Grid item>\n                    <FormControl className={classes.formControl} variant=\"outlined\" size=\"small\">\n                        <InputLabel id=\"breed-select-label\">Breed</InputLabel>\n                        <Select labelId=\"breed-select-label\" id=\"breed-select\" value={breed} onChange={handleBreedChange} label=\"Breed\">\n                            {(breeds[chosenSpecies] ?? []).map((breed) => (\n                                <MenuItem key={breed} value={breed}>\n                                    {breed}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </Grid>\n                <Grid item>\n                    <FormControl className={classes.formControl} variant=\"outlined\" size=\"small\">\n                        <InputLabel id=\"breed-select-label\">Sort by</InputLabel>\n                        <Select labelId=\"breed-select-label\" id=\"sort-select\" value={order} onChange={handleOrderChange} label=\"Sort by\">\n                            {orders.map((order) => (\n                                <MenuItem key={order} value={order}>\n                                    {order}\n                                </MenuItem>\n                            ))}\n                        </Select>\n                    </FormControl>\n                </Grid>\n                <Grid item>\n                    <div className={classes.ageSlider}>\n                        <Typography>Age Range</Typography>\n                        <Slider\n                            value={ageRange}\n                            onChange={handleAgeRangeChange}\n                            valueLabelDisplay=\"auto\"\n                            aria-labelledby=\"range-slider\"\n                            getAriaValueText={agetext}\n                            min={0.5}\n                            max={10}\n                            marks={ageMarks}\n                            className={classes.darkSlider}\n                        />\n                    </div>\n                </Grid>\n                <Grid item>\n                    <Button variant=\"contained\" color=\"default\" className={classes.button} onClick={loadPets}>\n                        Apply\n                    </Button>\n                </Grid>\n                <Grid item>\n                    <Button variant=\"contained\" color=\"default\" className={classes.button} onClick={resetFilters}>\n                        Reset filters\n                    </Button>\n                </Grid>\n            </Grid>\n            <SearchResults pets={pets} order={order} />\n            {totalPages ? (\n                <Box my={2} display=\"flex\" justifyContent=\"center\">\n                    <Pagination count={totalPages} variant=\"outlined\" shape=\"rounded\" onChange={handleChange} />\n                </Box>\n            ) : null}\n        </div>\n    );\n}\n\nexport default connect()(withRouter(SearchView));\n"]},"metadata":{},"sourceType":"module"}